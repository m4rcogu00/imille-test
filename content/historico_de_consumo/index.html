+++
title = "Historico de Consumo CE"
layout = "moduli_private_area_brasil"
+++

<div class="pvtArea-main pvtArea-column pvtArea-composicao-faturamento">
    <div class="pvtArea-breadcrumb desktop-visible">
        <span>INÍCIO / SEGUNDA VIA</span>
    </div>

    <div class="pvtArea-account mobile-white">
        <div class="pvtArea-account-row pvtArea-account-row-faturamento">
            <div class="pvtArea-account-table-row threeItems">
                <div class="pvtArea-account-table-item">
                    <span class="pvtArea-account-item-title">Títular da conta</span>
                    <span class="text">Marta Nunes</span>
                </div>
                <div class="pvtArea-account-table-item">
                    <span class="pvtArea-account-item-title">Nº da Instalação</span>
                    <span class="text">3854491796</span>
                </div>
                <div class="pvtArea-account-table-item">
                    <span class="pvtArea-account-item-title">Endereço de instalação</span>
                    <span class="text"> Rua Domingos Sávio, 123, Pedra, Eusébio, CE
                    </span>
                </div>
            </div>
        </div>
    </div>

    <div class="pvtArea-account mobile-white">
        
        <div class="pvtArea-info-box">

            <h2>
                Histórico de Consumo
            </h2>
            
            <div class="pvtArea-info-box-icon-box">
                <div>
                    <img src="../img/icons/icon-bulb.svg" />
                </div>
                <p>
                    Tenha acesso rápido e fácil as faturas de códigos de barras da sua Unidade Consumidora.
                </p>
            </div>
            
            <p class="pvtArea-account-item-text">
                Para realizar o download, clique no ícone PDF para impressão; ou copie os códigos de barra para efetuar 
                os pagamentos online:
            </p>
        </div>

        <table class="table-pvt responsive display" id="tablaHistoricoConsumo">
            <thead>
              <tr>
                <th scope="col" width="12%">N°</th>
                <th scope="col" width="6%">Data de Leitura</th>
                <th scope="col" width="12%">Leitura</th>
                <th scope="col" width="18%">Referência</th>
                <th scope="col" width="12%">Consumo (Kwh)</th>
                <th scope="col" width="15%">Vencimiento</th>
                <th scope="col" width="6%">Tipo</th>
                <th scope="col" width="6%">Valor</th>
                <th scope="col" width="12%">Pagamento</th>
              </tr>
            </thead>
            <tbody>
                <tr>
                    <td data-label="N°" class="details-control">47 </td>
                    <td data-label="Data de Leitura">26/10/2019</td>
                    <td data-label="Leitura">10/2019</td>
                    <td data-label="Referência"> 10/2019</td>
                    <td data-label="Consumo (Kwh)">2391</td>
                    <td data-label="Vencimiento">05/11/2019</td>
                    <td data-label="Tipo">Fatura</td>
                    <td data-label="Valor">R$ 99,99</td>
                    <td data-label="Pagamento">Em aberto</td>
                </tr>
            </tbody>
        </table>

        <div style="margin-top:48px">
            <button class="latam-btn-cta--lightgrey btn-hide-icons-xs">
                <span class="icon-debito_automatico"></span> <span>Código de Barras</span>
            </button>
        </div>

    </div>
</div>

<style>

    .chart-container{
        width: 100%  ;
        height: 300px;
        position: relative;
    }

</style>

<script>

$(function(){
    
    function format(d){
        return '<table class="table-pvt responsive display">'+
                    '<tr>'+
                        '<td>Média de los últimos 12 meses:'+d[4]+' Kwh</td>'+
                    '</tr>'+
                    '<tr>'+
                        '<td class="chart-container">'+
                            '<canvas id="graph-'+d[0]+'" class="chart"></canvas>'+
                        '</td>'+
                    '</tr>'+
                '</table>';
    }

    var tablaHistoricoConsumo = $('#tablaHistoricoConsumo').DataTable( {
        "ordering": false,
        "info": false,
        "searching": false,
        "scrollX": false,
        "lengthChange": false,
        "paging": true,
        "language": {
            "paginate": {
                "previous": "Anterior",
                "next": "Próxima"
            }
        }
    });

    $('#tablaHistoricoConsumo tbody').on('click', 'td.details-control', function () {
        var tr = $(this).closest('tr');
        var row = tablaHistoricoConsumo.row( tr );
 
        if ( row.child.isShown() ) {
            // This row is already open - close it
            row.child.hide();
            tr.removeClass('shown');
        }
        else {

            var data = row.data();
            // Open this row
            console.log(row.data());

            row.child( format(data)).show();
            tr.addClass('shown');

            initGraph( data );
        }
    } );


    function initGraph(data){

        var ctx = document.getElementById("graph-"+data[0]).getContext('2d');
    
        var data = {
            labels: ["Enero", "Febrero", "Marzo"],
            datasets: [{
                label: '2018',
                data: [1, 2, 3],
                backgroundColor: '#6fabd2',
                hoverBackgroundColor: '#6fabd2',
                borderWidth: 0,
                fill: true
            }]
        };
        
        console.log(options);

        var myChart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: options
        });
    }

    
    
    var options = {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
            display: true,
            labels: {
                boxWidth: 12,
                padding: 25
            }
        },
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true,
                    maxTicksLimit: 5,
                    padding: 0,
                    gridLines: {
                        color: '#f2f2f4'
                    },
                },
                scaleLabel: {
                    display: true,
                    labelString: 'Consumo',
                    fontSize: 14
                }
            }]
        },
        tooltips: {
            enabled: false
        }
    };

})

</script>
